
const text = `
Привет! Я AI Регламентер, ваш специальный AI помощник. Я помогу вам описать процесс организации и проведения конкурса по спортивному программированию в структурированном виде, чтобы на его основе можно было настроить AI агентов для автоматизации и поддержки этой деятельности.

Спасибо за предоставленную информацию! Я уже начал анализировать данные и готовлю первые выводы для заполнения регламента. Давайте начнем с общих положений и постепенно углубимся в детали.

**Первый шаг: Общие положения и сбор контекста.**

На основе вашего описания и названия документа, я уже могу сделать некоторые выводы. Позвольте мне их озвучить для подтверждения, чтобы мы двигались дальше.

{{pending: **Вывод 1 (Общие положения):**
1.  **Официальное название компании:** АНО ДЛО ДО «Байкальский центр спортивного программирования».
2.  **Область деятельности:** Образовательная и спортивная деятельность в сфере IT, в частности, спортивное программирование.
3.  **Назначение регламента:** Регламентирует процесс организации и проведения конкурса по спортивному программированию в рамках фестиваля «Компьютериада».
4.  **Основной документ:** «Регламент проведения конкурса по спортивному программированию в рамках фестиваля «Компьютериада»».
5.  **Цель процесса:** Популяризация спортивного программирования, выявление талантливых участников и развитие интереса к IT и алгоритмическому мышлению.
6.  **Границы процесса:**
    *   **Начало:** Утверждение положения о конкурсе и запуск подготовки (за 3 месяца до фестиваля).
    *   **Завершение:** Награждение, публикация итогов и сбор обратной связи.
7.  **Потребители продукта:** Администрация фестиваля, городские органы образования, участники и их наставники, партнёры/спонсоры.
8.  **Документы/артефакты:** Положение о конкурсе, календарный план, задания, регламент проведения, списки участников, протоколы жюри, итоговый отчёт, публикация результатов на сайте.
9.  **Шаги процесса (предварительный перечень):**
    *   Шаг 1. Подготовка регламента и структуры конкурса
    *   Шаг 2. Формирование оргкомитета и жюри
    *   Шаг 3. Подготовка задач и платформы
}} Верно ли это понимание? Если да, мы можем использовать эти данные для заполнения разделов 1 и 2 регламента.
`;

function extractStepsFromText(textRaw) {
  const text = String(textRaw || '');
  // Existing regex
  const matches = Array.from(text.matchAll(/Шаг\s*(\d+)\.?\s*([^\n\r]+)/gi));
  
  if (!matches.length) console.log("No steps found with regex 1");

  return matches.map(m => ({ id: m[1], label: m[2].trim() }));
}

function heuristicPatchFromText(textRaw) {
  const text = String(textRaw || '').replace(/\r\n?/g, '\n').trim();
  const patch = {};

  const normalize = (s) => s ? s.trim() : null;

  // Emulating regexes I plan to add
  
  // Organization
  const orgMatch = text.match(/\*\*Официальное название компании:\*\*\s*(.+)/i); // Removed start of line anchor
  if (orgMatch) console.log("Found Org:", orgMatch[1]);
  else console.log("No Org found");

  // Process
  const procMatch = text.match(/\*\*Назначение регламента:\*\*\s*(.+)/i) || 
                   text.match(/\bрегламентирует\s+процесс\s+([^\n.]+)/i);
  if (procMatch) console.log("Found Process:", procMatch[1]);
  else console.log("No Process found");

  // Goal
  const goalMatch = text.match(/\*\*Цель процесса:\*\*\s*(.+)/i);
  if (goalMatch) console.log("Found Goal:", goalMatch[1]);

  return patch;
}

console.log("Steps Look like:", extractStepsFromText(text));
heuristicPatchFromText(text);
